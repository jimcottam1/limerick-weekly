<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Limerick Weekly - Saturday Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            background: #f8f8f8;
            color: #000;
            line-height: 1.4;
        }

        .newspaper {
            max-width: 1000px;
            margin: 20px auto;
            background: #fff;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
            padding: 20px;
        }

        /* Masthead */
        .masthead {
            border-bottom: 4px double #000;
            border-top: 2px solid #000;
            padding: 20px 0 10px 0;
            margin-bottom: 10px;
        }

        .paper-name {
            text-align: center;
            font-family: 'Georgia', serif;
        }

        .paper-name h1 {
            font-size: 4.5rem;
            font-weight: 900;
            letter-spacing: 0.2em;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-style: italic;
        }

        .edition-info {
            text-align: center;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #000;
        }

        /* Navigation Tabs */
        .sections-nav {
            display: flex;
            border-bottom: 3px solid #000;
            margin-bottom: 20px;
            background: #000;
        }

        .section-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: #000;
            color: #fff;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-right: 1px solid #333;
            transition: background 0.2s;
        }

        .section-tab:last-child {
            border-right: none;
        }

        .section-tab:hover {
            background: #333;
        }

        .section-tab.active {
            background: #fff;
            color: #000;
        }

        /* Section Content */
        .section-content {
            display: none !important;
        }

        .section-content.active {
            display: block !important;
        }

        .section-header {
            border-bottom: 3px double #000;
            margin-bottom: 20px;
            padding-bottom: 5px;
        }

        .section-header h2 {
            font-size: 2.5rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Article Grid */
        .articles {
            column-count: 2;
            column-gap: 30px;
            margin-bottom: 30px;
        }

        .article {
            break-inside: avoid;
            margin-bottom: 25px;
            page-break-inside: avoid;
        }

        .article-number {
            display: inline-block;
            background: #000;
            color: #fff;
            padding: 3px 8px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .article h3 {
            font-size: 1.5rem;
            line-height: 1.2;
            margin-bottom: 8px;
            font-weight: 900;
        }

        .article h3 a {
            color: #000;
            text-decoration: none;
        }

        .article h3 a:hover {
            text-decoration: underline;
        }

        .article-summary {
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 8px;
            text-align: justify;
        }

        .article-meta {
            font-size: 0.85rem;
            color: #666;
            font-style: italic;
            margin-bottom: 5px;
        }

        .read-more {
            font-size: 0.85rem;
            font-weight: bold;
            text-decoration: none;
            color: #000;
            border-bottom: 1px solid #000;
        }

        .read-more:hover {
            border-bottom: 2px solid #000;
        }

        /* Front Page - Special Layout */
        .front-page .lead-story {
            column-span: all;
            border-bottom: 2px solid #000;
            margin-bottom: 25px;
            padding-bottom: 20px;
        }

        .front-page .lead-story h3 {
            font-size: 2.5rem;
            line-height: 1.1;
        }

        .front-page .lead-story .article-summary {
            font-size: 1.1rem;
            column-count: 2;
            column-gap: 20px;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px;
            font-size: 1.2rem;
        }

        /* Footer */
        .footer {
            border-top: 2px solid #000;
            margin-top: 30px;
            padding-top: 15px;
            text-align: center;
            font-size: 0.85rem;
        }

        @media (max-width: 768px) {
            .articles {
                column-count: 1;
            }

            .paper-name h1 {
                font-size: 2.5rem;
            }

            .sections-nav {
                flex-wrap: wrap;
            }

            .section-tab {
                flex: 1 1 33%;
            }
        }
    </style>
</head>
<body>
    <div class="newspaper">
        <!-- Masthead -->
        <header class="masthead">
            <div class="paper-name">
                <h1>The Limerick Weekly</h1>
            </div>
            <div class="edition-info">
                <span id="currentDate"></span> ‚Ä¢ AI-Generated Local News ‚Ä¢ Limerick, Ireland
            </div>
        </header>

        <!-- Section Navigation -->
        <nav class="sections-nav">
            <div class="section-tab active" onclick="showSection('frontpage', this)">Front Page</div>
            <div class="section-tab" onclick="showSection('sport', this)">Sport</div>
            <div class="section-tab" onclick="showSection('local', this)">Local News</div>
            <div class="section-tab" onclick="showSection('politics', this)">Politics</div>
            <div class="section-tab" onclick="showSection('business', this)">Business</div>
            <div class="section-tab" onclick="showSection('culture', this)">Culture</div>
        </nav>

        <!-- Loading -->
        <div id="loadingMessage" class="loading">
            üì∞ Loading today's edition...
        </div>

        <!-- Front Page Section -->
        <div id="section-frontpage" class="section-content active">
            <div class="section-header">
                <h2>Today's Headlines</h2>
            </div>
            <div class="articles front-page" id="frontpage-articles"></div>
        </div>

        <!-- Sport Section -->
        <div id="section-sport" class="section-content">
            <div class="section-header">
                <h2>‚öΩ Sport</h2>
            </div>
            <div class="articles" id="sport-articles"></div>
        </div>

        <!-- Local News Section -->
        <div id="section-local" class="section-content">
            <div class="section-header">
                <h2>üèòÔ∏è Local News</h2>
            </div>
            <div class="articles" id="local-articles"></div>
        </div>

        <!-- Politics Section -->
        <div id="section-politics" class="section-content">
            <div class="section-header">
                <h2>üèõÔ∏è Politics</h2>
            </div>
            <div class="articles" id="politics-articles"></div>
        </div>

        <!-- Business Section -->
        <div id="section-business" class="section-content">
            <div class="section-header">
                <h2>üíº Business</h2>
            </div>
            <div class="articles" id="business-articles"></div>
        </div>

        <!-- Culture Section -->
        <div id="section-culture" class="section-content">
            <div class="section-header">
                <h2>üé≠ Culture & Events</h2>
            </div>
            <div class="articles" id="culture-articles"></div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p><strong>The Limerick Weekly</strong> ‚Ä¢ Established 2025</p>
            <p>All articles AI-generated and rewritten for local relevance</p>
        </footer>
    </div>

    <script>
        // Set current date
        const dateEl = document.getElementById('currentDate');
        const today = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        dateEl.textContent = today.toLocaleDateString('en-IE', options);

        // Section switching
        function showSection(sectionName, element) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.section-tab').forEach(t => t.classList.remove('active'));

            // Show selected section
            document.getElementById('section-' + sectionName).classList.add('active');
            element.classList.add('active');
        }

        // Categorize articles
        function categorizeArticle(article) {
            const text = (article.headline + ' ' + article.story).toLowerCase();

            if (text.match(/sport|rugby|gaa|football|hurling|racing|horse|match|team|athletic/i)) return 'sport';
            if (text.match(/politics|government|election|party|minister|td|council|vote|candidate/i)) return 'politics';
            if (text.match(/business|economy|jobs|company|enterprise|economic|trade|investment/i)) return 'business';
            if (text.match(/culture|arts|music|festival|event|concert|theatre|exhibition|book/i)) return 'culture';

            return 'local';
        }

        // Load and display articles
        async function loadArticles() {
            try {
                const response = await fetch('/api/articles/recent?limit=50');
                const data = await response.json();

                if (data.articles.length === 0) {
                    document.getElementById('loadingMessage').innerHTML = 'üì∞ No articles available.';
                    return;
                }

                // Categorize articles
                const categories = {
                    sport: [],
                    local: [],
                    politics: [],
                    business: [],
                    culture: []
                };

                data.articles.forEach(article => {
                    const category = categorizeArticle(article);
                    categories[category].push(article);
                });

                // Display articles in each section
                displayArticles(categories.sport, 'sport-articles', categories.sport.length);
                displayArticles(categories.local, 'local-articles', categories.local.length);
                displayArticles(categories.politics, 'politics-articles', categories.politics.length);
                displayArticles(categories.business, 'business-articles', categories.business.length);
                displayArticles(categories.culture, 'culture-articles', categories.culture.length);

                // Front page gets mix of top stories from all categories
                const frontPage = [
                    ...categories.sport.slice(0, 2),
                    ...categories.local.slice(0, 3),
                    ...categories.politics.slice(0, 2),
                    ...categories.business.slice(0, 1),
                    ...categories.culture.slice(0, 2)
                ].slice(0, 10);

                displayArticles(frontPage, 'frontpage-articles', frontPage.length, true);

                document.getElementById('loadingMessage').style.display = 'none';

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loadingMessage').innerHTML = '‚ùå Error loading articles.';
            }
        }

        function displayArticles(articles, containerId, count, isFrontPage = false) {
            const container = document.getElementById(containerId);

            if (articles.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 40px; color: #666;">No articles in this section.</p>';
                return;
            }

            articles.forEach((article, index) => {
                const articleId = article.originalLink.replace(/[^a-z0-9]/gi, '-');
                const firstParagraph = article.story.split('\n\n')[0];
                const summary = firstParagraph.length > 150
                    ? firstParagraph.substring(0, 150) + '...'
                    : firstParagraph;

                const isLeadStory = isFrontPage && index === 0;
                const articleDiv = document.createElement('div');
                articleDiv.className = 'article' + (isLeadStory ? ' lead-story' : '');

                articleDiv.innerHTML = `
                    <div class="article-number">${isLeadStory ? 'LEAD STORY' : `STORY ${index + 1}`}</div>
                    <h3><a href="/articles/${articleId}.html">${article.headline}</a></h3>
                    <p class="article-summary">${summary}</p>
                    <div class="article-meta">${article.originalSource}</div>
                    <a href="/articles/${articleId}.html" class="read-more">Continue reading ‚Üí</a>
                `;

                container.appendChild(articleDiv);
            });
        }

        // Load articles on page load
        loadArticles();
    </script>
</body>
</html>
